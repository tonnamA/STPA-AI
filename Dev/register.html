<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="navbar.css">
    <link rel="stylesheet" href="login.css">

</head>

<body>
    <nav>
        <ul>
            <li><a href="#" class="special">STPA-AI</a></li>
            <div class="center">
                <li class="hide"><a href="setting.html" class="change" id="nav-setting">เข้าสู่ระบบ</a></li>
                <li class="hide"><a href="content.html" class="change" id="nav-content">ฝึกฝน</a></li>
                <li class="hide"><a href="#" class="change">API's</a></li>
            </div>
            <li><a href="#" class="hide"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960"
                        width="24px" fill="#1f1f1f">
                        <path
                            d="M480-360q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35Zm0 80q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM200-440H40v-80h160v80Zm720 0H760v-80h160v80ZM440-760v-160h80v160h-80Zm0 720v-160h80v160h-80ZM256-650l-101-97 57-59 96 100-52 56Zm492 496-97-101 53-55 101 97-57 59Zm-98-550 97-101 59 57-100 96-56-52ZM154-212l101-97 55 53-97 101-59-57Zm326-268Z" />
                    </svg></a></li>
            <li class="menubtn"><a href="#" onclick="showsidebar()"><svg xmlns="http://www.w3.org/2000/svg"
                        height="26px" viewBox="0 -960 960 960" width="26px" fill="#1f1f1f">
                        <path d="M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z" /></svg></a></li>
        </ul>
    </nav>
    <main>
        <form action="#" onsubmit="register(event)" class="form-input register">
            <h1>ลงทะเบียน</h1>
            <div class="name input">
                <h2>ชื่อ-นามสกุล</h2>
                <input type="text" id="name" name="name" placeholder="example@domain.tld" required>
            </div>
            <div class="email input">
                <h2>อีเมล</h2>
                <input type="email" id="email" name="email" placeholder="example@domain.tld"required>
            </div>
            <div class="username input">
                <h2>ชื่อผู้ใช้</h2>
                <input type="text" id="username" name="username" placeholder="PATlnwza"required>
            </div>
            <div class="password input">
                <h2>รหัสผ่าน</h2>
                <input type="password" name="password" id="password" placeholder="••••••••"required>
            </div>
            <div class="confirm-password input">
                <h2>ยืนยันรหัสผ่าน</h2>
                <input type="password" name="confirmpassword" id="confirmpassword" placeholder="••••••••"required>
            </div>
            <div class="login-google">
                <button><span><svg width="29" height="28" viewBox="0 0 29 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g id="Google__G__logo 1">
                    <path id="Vector" d="M26.82 14.2959C26.82 13.3859 26.7383 12.5109 26.5867 11.6709H14.5V16.6409H21.4067C21.1033 18.2392 20.1933 19.5926 18.8283 20.5026V23.7342H22.9933C25.42 21.4942 26.82 18.2042 26.82 14.2959Z" fill="#4285F4"/>
                    <path id="Vector_2" d="M14.5 26.8374C17.965 26.8374 20.87 25.6941 22.9933 23.7341L18.8283 20.5024C17.685 21.2724 16.2267 21.7391 14.5 21.7391C11.1633 21.7391 8.32833 19.4874 7.31333 16.4541H3.04333V19.7674C5.155 23.9558 9.48333 26.8374 14.5 26.8374Z" fill="#34A853"/>
                    <path id="Vector_3" d="M7.31335 16.4424C7.05669 15.6724 6.90502 14.8558 6.90502 14.0041C6.90502 13.1524 7.05669 12.3358 7.31335 11.5658V8.25244H3.04335C2.16835 9.97911 1.66669 11.9274 1.66669 14.0041C1.66669 16.0808 2.16835 18.0291 3.04335 19.7558L6.36835 17.1658L7.31335 16.4424Z" fill="#FBBC05"/>
                    <path id="Vector_4" d="M14.5 6.2809C16.39 6.2809 18.07 6.93423 19.4117 8.19423L23.0867 4.51923C20.8583 2.44257 17.965 1.1709 14.5 1.1709C9.48334 1.1709 5.155 4.05257 3.04333 8.25257L7.31334 11.5659C8.32834 8.53257 11.1633 6.2809 14.5 6.2809Z" fill="#EA4335"/>
                    </g>
                    </svg></span>เข้าสู่ระบบด้วย Google</button>
            </div>
            <div class="login input">
                <a href="login.html"">เข้าสู่ระบบ</a>
            </div>
            <button>ลงทะเบียน</button>
        </form>
    </main>
</body>
<nav>
    <ul class="sidebar">
        <li><a href="#" onclick="hidesidebar()"><svg xmlns="http://www.w3.org/2000/svg" height="24px"
                    viewBox="0 -960 960 960" width="24px" fill="#1f1f1f">
                    <path
                        d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z" />
                </svg></a></li>
        <div class="center">
            <li><a href="setting.html" class="change">เข้าสู่ระบบ</a></li>
            <li><a href="content.html" class="change">ฝึกฝน</a></li>
            <li><a href="#" class="change" id="nav-api">API's</a></li>
        </div>
        <li><a href="#"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                    fill="#1f1f1f">
                    <path
                        d="M480-360q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35Zm0 80q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM200-440H40v-80h160v80Zm720 0H760v-80h160v80ZM440-760v-160h80v160h-80Zm0 720v-160h80v160h-80ZM256-650l-101-97 57-59 96 100-52 56Zm492 496-97-101 53-55 101 97-57 59Zm-98-550 97-101 59 57-100 96-56-52ZM154-212l101-97 55 53-97 101-59-57Zm326-268Z" />
                </svg></a></li>
    </ul>
</nav>
<style>
     .login{
        text-align: right;

        /* TH/body/regular/base */
        font-family: "IBM Plex Sans Thai";
        font-size: 16px;
        font-style: normal;
        font-weight: 400;
        line-height: 144%; /* 23.04px */
        letter-spacing: 1px;
        
    }
    .login a{
        text-decoration: none;
        color: var(--Color-Palete-General-Purpose-black, #000);
    }
    .login-google button{
        background: white;
        color: black;
    }
</style>

<script>
      window.addEventListener("DOMContentLoaded",() => {
        const currentpath = window.location.pathname;

        if(currentpath.includes("setting.html")){
            document.getElementById("nav-setting")?.classList.add("active-link")
        }else if(currentpath.includes("content.html")){
            document.getElementById("nav-practice")?.classList.add("active-link")
        }else if(currentpath.includes("main.py")){
            document.getElementById("nav-api")?.classList.add("active-link")
        }
    })
    const change = document.querySelectorAll(".change");
    change.forEach(item => {
        item.addEventListener("click", function (e) {
            change.forEach(btn => btn.classList.remove('backchange'));
            item.classList.add('backchange');
            e.stopPropagation();
        })
    })

    function showsidebar() {
        const sidebar = document.querySelector(".sidebar");
        sidebar.classList.add("active");
    }
    
    function hidesidebar() {
        const sidebar = document.querySelector(".sidebar");
        sidebar.classList.remove("active");
    }

    function register(event){
        event.preventDefault();
        fetch("http://127.0.0.1:8000/register" , {
            method:"POST",
            headers: {
                    "Content-Type": "application/json"
                },
            body: JSON.stringify({
                name:document.getElementById("name").value,
                email:document.getElementById("email").value,
                username:document.getElementById("username").value,
                password:document.getElementById("password").value,
                confirmpassword:document.getElementById("confirmpassword").value
            })

        })
        .then(res => res.json())
        .then(data => {
            alert(data.detail || data.message)
            if(data.message){
                window.location.href = "content.html";
            }
        })
    }






    // function isValidUsername(username) {
    //     const regex = /^[a-zA-Z0-9_]+$/; // อนุญาตให้ใช้ a-z, A-Z, 0-9 และ _
    //     return regex.test(username);
    // }

    // function isValidPassword(password) {
    //     const regex = /^[a-zA-Z0-9_]+$/; // อนุญาตให้ใช้ a-z, A-Z, 0-9 และ _
    //     return regex.test(password);
    // }

    // function isValidThaiName(name) {
    //     const regex = /^[ก-๙\s]+$/; // อนุญาตให้ใช้ตัวอักษรไทยทั้งหมด + ช่องว่าง
    //     return regex.test(name);
    // }

    // function isValidEmail(email) {
    //     const regex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.(com|net|org|co\.th|ac\.th|edu|gov|hotmail|gmail)$/;
    //     return regex.test(email);
    // }



    // function register(event) {
    //     event.preventDefault();
    //     const username = document.getElementById("username").value.trim();
    //     const password = document.getElementById("password").value.trim();
    //     const name = document.getElementById("name").value;
    //     const email = document.getElementById("email").value;
    //     const confirmpassword = document.getElementById("confirmpassword").value;
    //     const userdata = {
    //         password: password,
    //         name: name,
    //         email: email
    //     }


    //     if (!username || !password || !name || !email || !confirmpassword) {
    //         alert("กรุณาใส่ข้อมูลผู้ใช้ให้ครบถ้วน");
    //         return false;
    //     }
    //     if (confirmpassword != password) {
    //         alert("รหัสผ่านไม่ตรงกัน");
    //         return false;
    //     }
    //     if (localStorage.getItem(username)) {
    //         alert("username นี้มีอยู่แล้ว");
    //         return false;
    //     }
    //     if (!isValidUsername(username)) {
    //         alert("กรุณากรอกชื่อผู้ใช้ด้วยตัวอักษรภาษาอังกฤษเท่านั้น")
    //         return false;
    //     }
    //     if (!isValidPassword(password)) {
    //         alert("กรุณาตั้ง password ด้วย 0-9 a-z หรือ _")
    //         return false;
    //     }
    //     if (!isValidThaiName(name)) {
    //         alert("กรุณากรอกชื่อ-นามสุกลด้วยตัวอักษรภาษาไทยเท่านั้น")
    //         return false;
    //     }
    //     if (!isValidEmail(email)) {
    //         alert("กรุณากรอกอีเมลที่ถูกต้อง");
    //         return false;
    //     }


    //     for (let i = 0; i < localStorage.length; i++) {
    //         const key = localStorage.key(i);
    //         try {
    //             const storedata = JSON.parse(localStorage.getItem(key));
    //             if (storedata && storedata.email === email) {
    //                 alert("มีอีเมลนี้อยู่ในระบบแล้ว");
    //                 return false;
    //             }
    //         } catch (e) {
    //             continue; // ข้าม key ที่ไม่ใช่ JSON
    //         }

    //     }
    //     localStorage.setItem(username, JSON.stringify(userdata));
    //     alert("register successfully");
    //     location.replace("content.html")
    //     return true;
    // }

</script>

</html>